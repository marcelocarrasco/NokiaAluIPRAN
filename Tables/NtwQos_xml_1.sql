--
-- Tabla auxiliar para almacenar la info del archivo YYYYMMDDHH24MI_NtwQos.xml_1
-- DROP TABLE XML_NTWQOS_1 PURGE;

CREATE TABLE XML_NTWQOS_1 (
    FECHA                             DATE GENERATED ALWAYS AS (TO_DATE(SUBSTR(NOMBRE_CSV,-23,2)||'.'||
                                                                              SUBSTR(NOMBRE_CSV,-25,2)||'.'||
                                                                              SUBSTR(NOMBRE_CSV,-29,4)||' '||
                                                                              SUBSTR(NOMBRE_CSV,-21,2)||':'||
                                                                              SUBSTR(NOMBRE_CSV,-19,2),'DD.MM.YYYY HH24:MI')) VIRTUAL
    ,PORT_ID	                        VARCHAR2(50 CHAR)
    ,QUEUE_ID	                        NUMBER
    ,LAG_PORT	                        VARCHAR2(50 CHAR)
    ,TIME_RECORDED	                  NUMBER
    ,IN_PROFILE_OCTETS_FORWARDED	    NUMBER
    ,IN_PROFILE_OCTETS_DROPPED	      NUMBER
    ,OUT_OF_PROFILE_OCTETS_FWDED    	NUMBER
    ,OUT_OF_PROFILE_OCTETS_DROPPED	  NUMBER
    ,MONITORED_OBJECT_SITE_ID	        VARCHAR2(15 CHAR)
    ,MONITORED_OBJECT_SITE_NAME	      VARCHAR2(500 CHAR)
    ,MEDICION                         VARCHAR2(50 CHAR)
    ,NOMBRE_CSV                       VARCHAR2(100 CHAR)
) NOCOMPRESS NOLOGGING
PARTITION BY RANGE (FECHA)
(PARTITION NTWQOS120161128 VALUES LESS THAN (TO_DATE('29.11.2016','DD.MM.YYYY')) TABLESPACE DEVELOPER PCTFREE 10 PCTUSED 80)
 TABLESPACE DEVELOPER;

COMMENT ON TABLE XML_NTWQOS_1 IS 'Tabla auxiliar para almacenar la info del archivo YYYYMMDDHH24MI_NtwQos.xml_1';
COMMENT ON COLUMN XML_NTWQOS_1.OUT_OF_PROFILE_OCTETS_FWDED IS 'Reescritura de la columna OUT_OF_PROFILE_OCTETS_FORWARDED por superar los 30 char';

ALTER TABLE XML_NTWQOS_1 ADD PARTITION NTWQOS120161129 VALUES LESS THAN (TO_DATE('30.11.2016','DD.MM.YYYY')) TABLESPACE DEVELOPER PCTFREE 10 PCTUSED 80;
ALTER TABLE XML_NTWQOS_1 ADD PARTITION NTWQOS120161130 VALUES LESS THAN (TO_DATE('01.12.2016','DD.MM.YYYY')) TABLESPACE DEVELOPER PCTFREE 10 PCTUSED 80;
ALTER TABLE XML_NTWQOS_1 ADD PARTITION NTWQOS120161201 VALUES LESS THAN (TO_DATE('02.12.2016','DD.MM.YYYY')) TABLESPACE DEVELOPER PCTFREE 10 PCTUSED 80;
ALTER TABLE XML_NTWQOS_1 ADD PARTITION NTWQOS120161202 VALUES LESS THAN (TO_DATE('03.12.2016','DD.MM.YYYY')) TABLESPACE DEVELOPER PCTFREE 10 PCTUSED 80;
ALTER TABLE XML_NTWQOS_1 ADD PARTITION NTWQOS120161203 VALUES LESS THAN (TO_DATE('04.12.2016','DD.MM.YYYY')) TABLESPACE DEVELOPER PCTFREE 10 PCTUSED 80;
ALTER TABLE XML_NTWQOS_1 ADD PARTITION NTWQOS120161204 VALUES LESS THAN (TO_DATE('05.12.2016','DD.MM.YYYY')) TABLESPACE DEVELOPER PCTFREE 10 PCTUSED 80;
ALTER TABLE XML_NTWQOS_1 ADD PARTITION NTWQOS120161205 VALUES LESS THAN (TO_DATE('06.12.2016','DD.MM.YYYY')) TABLESPACE DEVELOPER PCTFREE 10 PCTUSED 80;
ALTER TABLE XML_NTWQOS_1 ADD PARTITION NTWQOS120161206 VALUES LESS THAN (TO_DATE('07.12.2016','DD.MM.YYYY')) TABLESPACE DEVELOPER PCTFREE 10 PCTUSED 80;
ALTER TABLE XML_NTWQOS_1 ADD PARTITION NTWQOS120161207 VALUES LESS THAN (TO_DATE('08.12.2016','DD.MM.YYYY')) TABLESPACE DEVELOPER PCTFREE 10 PCTUSED 80;
ALTER TABLE XML_NTWQOS_1 ADD PARTITION NTWQOS120161208 VALUES LESS THAN (TO_DATE('09.12.2016','DD.MM.YYYY')) TABLESPACE DEVELOPER PCTFREE 10 PCTUSED 80;
ALTER TABLE XML_NTWQOS_1 ADD PARTITION NTWQOS120161209 VALUES LESS THAN (TO_DATE('10.12.2016','DD.MM.YYYY')) TABLESPACE DEVELOPER PCTFREE 10 PCTUSED 80;
ALTER TABLE XML_NTWQOS_1 ADD PARTITION NTWQOS120161210 VALUES LESS THAN (TO_DATE('11.12.2016','DD.MM.YYYY')) TABLESPACE DEVELOPER PCTFREE 10 PCTUSED 80;
ALTER TABLE XML_NTWQOS_1 ADD PARTITION NTWQOS120161211 VALUES LESS THAN (TO_DATE('12.12.2016','DD.MM.YYYY')) TABLESPACE DEVELOPER PCTFREE 10 PCTUSED 80;
ALTER TABLE XML_NTWQOS_1 ADD PARTITION NTWQOS120161212 VALUES LESS THAN (TO_DATE('13.12.2016','DD.MM.YYYY')) TABLESPACE DEVELOPER PCTFREE 10 PCTUSED 80;
ALTER TABLE XML_NTWQOS_1 ADD PARTITION NTWQOS120161213 VALUES LESS THAN (TO_DATE('14.12.2016','DD.MM.YYYY')) TABLESPACE DEVELOPER PCTFREE 10 PCTUSED 80;
ALTER TABLE XML_NTWQOS_1 ADD PARTITION NTWQOS120161214 VALUES LESS THAN (TO_DATE('15.12.2016','DD.MM.YYYY')) TABLESPACE DEVELOPER PCTFREE 10 PCTUSED 80;
ALTER TABLE XML_NTWQOS_1 ADD PARTITION NTWQOS120161215 VALUES LESS THAN (TO_DATE('16.12.2016','DD.MM.YYYY')) TABLESPACE DEVELOPER PCTFREE 10 PCTUSED 80;
ALTER TABLE XML_NTWQOS_1 ADD PARTITION NTWQOS120161216 VALUES LESS THAN (TO_DATE('17.12.2016','DD.MM.YYYY')) TABLESPACE DEVELOPER PCTFREE 10 PCTUSED 80;
ALTER TABLE XML_NTWQOS_1 ADD PARTITION NTWQOS120161217 VALUES LESS THAN (TO_DATE('18.12.2016','DD.MM.YYYY')) TABLESPACE DEVELOPER PCTFREE 10 PCTUSED 80;
ALTER TABLE XML_NTWQOS_1 ADD PARTITION NTWQOS120161218 VALUES LESS THAN (TO_DATE('19.12.2016','DD.MM.YYYY')) TABLESPACE DEVELOPER PCTFREE 10 PCTUSED 80;
ALTER TABLE XML_NTWQOS_1 ADD PARTITION NTWQOS120161219 VALUES LESS THAN (TO_DATE('20.12.2016','DD.MM.YYYY')) TABLESPACE DEVELOPER PCTFREE 10 PCTUSED 80;
ALTER TABLE XML_NTWQOS_1 ADD PARTITION NTWQOS120161220 VALUES LESS THAN (TO_DATE('21.12.2016','DD.MM.YYYY')) TABLESPACE DEVELOPER PCTFREE 10 PCTUSED 80;
ALTER TABLE XML_NTWQOS_1 ADD PARTITION NTWQOS120161221 VALUES LESS THAN (TO_DATE('22.12.2016','DD.MM.YYYY')) TABLESPACE DEVELOPER PCTFREE 10 PCTUSED 80;
ALTER TABLE XML_NTWQOS_1 ADD PARTITION NTWQOS120161222 VALUES LESS THAN (TO_DATE('23.12.2016','DD.MM.YYYY')) TABLESPACE DEVELOPER PCTFREE 10 PCTUSED 80;
ALTER TABLE XML_NTWQOS_1 ADD PARTITION NTWQOS120161223 VALUES LESS THAN (TO_DATE('24.12.2016','DD.MM.YYYY')) TABLESPACE DEVELOPER PCTFREE 10 PCTUSED 80;
ALTER TABLE XML_NTWQOS_1 ADD PARTITION NTWQOS120161224 VALUES LESS THAN (TO_DATE('25.12.2016','DD.MM.YYYY')) TABLESPACE DEVELOPER PCTFREE 10 PCTUSED 80;
ALTER TABLE XML_NTWQOS_1 ADD PARTITION NTWQOS120161225 VALUES LESS THAN (TO_DATE('26.12.2016','DD.MM.YYYY')) TABLESPACE DEVELOPER PCTFREE 10 PCTUSED 80;
ALTER TABLE XML_NTWQOS_1 ADD PARTITION NTWQOS120161226 VALUES LESS THAN (TO_DATE('27.12.2016','DD.MM.YYYY')) TABLESPACE DEVELOPER PCTFREE 10 PCTUSED 80;
ALTER TABLE XML_NTWQOS_1 ADD PARTITION NTWQOS120161227 VALUES LESS THAN (TO_DATE('28.12.2016','DD.MM.YYYY')) TABLESPACE DEVELOPER PCTFREE 10 PCTUSED 80;
ALTER TABLE XML_NTWQOS_1 ADD PARTITION NTWQOS120161228 VALUES LESS THAN (TO_DATE('29.12.2016','DD.MM.YYYY')) TABLESPACE DEVELOPER PCTFREE 10 PCTUSED 80;
ALTER TABLE XML_NTWQOS_1 ADD PARTITION NTWQOS120161229 VALUES LESS THAN (TO_DATE('30.12.2016','DD.MM.YYYY')) TABLESPACE DEVELOPER PCTFREE 10 PCTUSED 80;
ALTER TABLE XML_NTWQOS_1 ADD PARTITION NTWQOS120161230 VALUES LESS THAN (TO_DATE('31.12.2016','DD.MM.YYYY')) TABLESPACE DEVELOPER PCTFREE 10 PCTUSED 80;
ALTER TABLE XML_NTWQOS_1 ADD PARTITION NTWQOS120161231 VALUES LESS THAN (TO_DATE('01.01.2017','DD.MM.YYYY')) TABLESPACE DEVELOPER PCTFREE 10 PCTUSED 80;